// Generated by CoffeeScript 1.9.3
$(function() {
  var Point, colorsArr, cs, filed, logo, points, pointsFiled, text, win;
  filed = $('.field');
  logo = $('.logo');
  cs = $('.circle-scene');
  text = $('.text');
  win = $(window);
  pointsFiled = $('#points');
  colorsArr = ['#42a5f5', '#ffee58', '#b388ff', '#fff', '#4068BF', '#ffd54f'];
  Point = (function() {
    function Point(x, y) {
      this.x = x;
      this.y = y;
    }

    Point.prototype.init = function() {
      this.initScene();
      return this.listeners();
    };

    Point.prototype.listeners = function() {
      filed.on('mousemove', (function(_this) {
        return function(e) {
          return _this.createPoint(e);
        };
      })(this));
      win.on('resize', (function(_this) {
        return function() {
          return _this.getCenterField();
        };
      })(this));
      return this.getCenterField();
    };

    Point.prototype.initScene = function() {
      var hideScene, scene;
      TweenMax.set(cs, {
        scale: 0,
        transformOrigin: "center center"
      });
      TweenMax.set(text, {
        scale: 0,
        transformOrigin: "center center"
      });
      hideScene = function() {
        return logo.fadeOut(400, function() {
          return this.remove();
        });
      };
      scene = new TimelineLite();
      scene.delay(.5);
      return scene.staggerTo(cs, .8, {
        scale: 1,
        ease: Quart.easeOut
      }, 0.1).staggerTo(cs, 1, {
        scale: 8,
        opacity: 0,
        ease: Quart.easeOut
      }, 0.1).to(text, .7, {
        scale: 1,
        ease: Bounce.easeOut,
        onComplete: hideScene
      });
    };

    Point.prototype.getCenterField = function() {
      var h, w;
      w = filed.innerWidth();
      h = filed.innerHeight();
      return TweenMax.set(filed, {
        attr: {
          viewBox: "0 0 " + w + " " + h
        }
      });
    };

    Point.prototype.createPoint = function(e) {
      var newElement;
      newElement = document.createElementNS("http://www.w3.org/2000/svg", 'circle');
      filed[0].appendChild(newElement);
      TweenMax.set(newElement, {
        attr: {
          fill: this.randomColor(colorsArr),
          cx: e.pageX,
          cy: e.pageY,
          r: 20
        }
      });
      return this.move(newElement);
    };

    Point.prototype.move = function(el) {
      var angle, deleteEl, hideCircle, poolRadius, radius, randomScale, xCenter, yCenter;
      xCenter = 0;
      yCenter = 0;
      poolRadius = 500;
      angle = Math.random() * Math.PI * 2;
      radius = Math.random() * poolRadius;
      randomScale = Math.random() * (2 - 0);
      deleteEl = function() {
        return $(el).remove();
      };
      hideCircle = function() {
        return TweenMax.to(el, 1, {
          scale: 0,
          transformOrigin: "center center",
          ease: Power4.easeInOut,
          onComplete: deleteEl
        });
      };
      return TweenMax.to(el, 1, {
        x: Math.cos(angle) * radius + xCenter,
        y: Math.sin(angle) * radius + yCenter,
        scale: randomScale,
        ease: Bounce.easeOut,
        onComplete: hideCircle
      });
    };

    Point.prototype.randomColor = function(arr) {
      var rc;
      rc = Math.floor(Math.random() * (arr.length - 1));
      return arr[rc];
    };

    return Point;

  })();
  points = new Point;
  return points.init();
});
